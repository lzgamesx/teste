<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reflexo Felino - Loading Game</title>
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #e6e6e8;
    margin: 0;
    padding: 20px;
    text-align: center;
  }
  #game-container {
    max-width: 450px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    position: relative;
  }
  #start-btn, #next-btn {
    padding: 14px 24px;
    font-size: 20px;
    background-color: #4caf50;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    margin-top: 20px;
    transition: 0.3s;
  }
  #start-btn:hover {
    background-color: #45a049;
  }
  #play-area {
    position: relative;
    width: 100%;
    height: 320px;
    margin: 20px 0;
    background: #f9f9f9;
    border: 2px dashed #4caf50;
    border-radius: 10px;
    overflow: hidden;
    display: none;
  }
  #toy {
    position: absolute;
    width: 60px;
    display: none;
    cursor: pointer;
    animation: blink 0.8s infinite;
  }
  @keyframes blink {
    0% { opacity: 0.3; }
    50% { opacity: 1; }
    100% { opacity: 0.3; }
  }
  #feedback, #countdown {
    font-size: 32px;
    font-weight: bold;
    color: #333;
    margin: 10px 0;
    display: none;
  }
  #score {
    font-size: 18px;
    margin-top: 10px;
    color: #555;
    display: none;
  }
  #progress-bar {
    width: 100%;
    background: #ccc;
    height: 10px;
    border-radius: 5px;
    overflow: hidden;
    margin: 10px 0;
    display: none;
  }
  #progress {
    height: 100%;
    background: #4caf50;
    width: 0%;
    transition: width 0.3s;
  }
  .star {
    position: absolute;
    width: 20px;
    height: 20px;
    background: gold;
    border-radius: 50%;
    animation: starFall 2s linear forwards;
  }
  @keyframes starFall {
    0% { top: 0; opacity: 1; }
    100% { top: 100%; opacity: 0; }
  }
</style>
</head>

<body>

<div id="game-container">
  <button id="start-btn">Começar o Jogo</button>
  
  <div id="countdown"></div>
  
  <div id="play-area">
    <img id="toy" src="img/bolinha.png" alt="Bolinha">
  </div>

  <div id="feedback"></div>

  <div id="progress-bar">
    <div id="progress"></div>
  </div>

  <div id="score">Acertos: 0 / 5</div>
</div>

<audio id="pop-sound" src="audio/pop.wav" preload="auto"></audio>
<audio id="meow-sound" src="audio/miau.mp3" preload="auto"></audio>

<script>
const startBtn = document.getElementById('start-btn');
const playArea = document.getElementById('play-area');
const toy = document.getElementById('toy');
const feedback = document.getElementById('feedback');
const countdown = document.getElementById('countdown');
const scoreDisplay = document.getElementById('score');
const popSound = document.getElementById('pop-sound');
const meowSound = document.getElementById('meow-sound');
const progressBar = document.getElementById('progress');
let score = 0;
const maxScore = 5;
let startTime;

startBtn.addEventListener('click', () => {
  startBtn.style.display = 'none';
  countdown.style.display = 'block';
  startCountdown();
});

function startCountdown() {
  let count = 3;
  countdown.innerText = count;
  countdown.style.transform = 'scale(1)';
  let timer = setInterval(() => {
    count--;
    if (count > 0) {
      countdown.innerText = count;
      countdown.style.transform = 'scale(1.2)';
      setTimeout(() => { countdown.style.transform = 'scale(1)'; }, 200);
    } else if (count === 0) {
      countdown.innerText = 'Já!';
      countdown.style.transform = 'scale(1.4)';
      setTimeout(() => {
        countdown.style.display = 'none';
        startGame();
      }, 600);
      clearInterval(timer);
    }
  }, 1000);
}

function startGame() {
  playArea.style.display = 'block';
  scoreDisplay.style.display = 'block';
  progressBar.parentElement.style.display = 'block';
  nextToy();
}

function nextToy() {
  setTimeout(showToy, Math.random() * 1500 + 800);
}

function showToy() {
  randomPosition();
  toy.style.display = 'block';
  startTime = new Date().getTime();
}

toy.addEventListener('click', () => {
  const reactionTime = new Date().getTime() - startTime;
  toy.style.display = 'none';
  popSound.play();
  
  if (reactionTime <= 600) {
    showFeedback('Pulo de Tigre!', '#4caf50');
    score++;
  } else if (reactionTime <= 1200) {
    showFeedback('Reflexo de Gatinho!', '#ffc107');
    score++;
  } else {
    showFeedback('Acorda, Garfield!', '#f44336');
  }

  updateProgress();
  if (score >= maxScore) {
    endGame();
  } else {
    nextToy();
  }
});

function randomPosition() {
  const areaWidth = playArea.offsetWidth - 60;
  const areaHeight = playArea.offsetHeight - 60;
  const x = Math.floor(Math.random() * areaWidth);
  const y = Math.floor(Math.random() * areaHeight);
  toy.style.left = x + 'px';
  toy.style.top = y + 'px';
}

function showFeedback(text, color) {
  feedback.textContent = text;
  feedback.style.color = color;
  feedback.style.display = 'block';
  feedback.style.transform = 'scale(1.3)';
  setTimeout(() => {
    feedback.style.transform = 'scale(1)';
  }, 300);
}

function updateProgress() {
  scoreDisplay.textContent = `Acertos: ${score} / ${maxScore}`;
  progressBar.style.width = (score / maxScore * 100) + '%';
}

function endGame() {
  toy.style.display = 'none';
  playArea.style.display = 'none';
  scoreDisplay.style.display = 'none';
  feedback.style.color = '#4caf50';
  feedback.style.fontSize = '24px';
  feedback.innerText = "Se divertiu? Imagina seu gato brincando 5 minutinhos por dia. Isso muda tudo no instinto dele!";
  feedback.style.display = 'block';
  meowSound.play();
  spawnStars();
}

function spawnStars() {
  for (let i = 0; i < 20; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = Math.random() * 100 + '%';
    star.style.animationDelay = (Math.random() * 2) + 's';
    document.getElementById('game-container').appendChild(star);

    setTimeout(() => {
      star.remove();
    }, 2000);
  }
}
</script>

</body>
</html>
